<!DOCTYPE html>
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:p="http://primefaces.org/ui"
  template="/templates/plantillaPrincipal.xhtml">
  <ui:define
    name="content">
    <p:panel 
      id="main"
      styleClass="ui-fluid">
      <h:form
        id="frmlist"
        prependId="false"
        rendered="#{auditoriaController.showList}">
        <h:outputText 
          value="#{bundle['auditoria.title.list']}"/>
        <p:separator />
        <p:panel
          id="pnlbtns">
          <p:panelGrid
            columns="6"
            layout="grid" 
            columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
            styleClass="ui-panelgrid-blank">
            <p:commandButton 
              value="#{bundle['commons.btn.refresh']}"
              title="#{bundle['commons.btn.refresh']}"
              icon="ui-icon-refresh"
              actionListener="#{auditoriaController.loadList()}"
              update="dtList"/>
          </p:panelGrid>
        </p:panel>
        <p:dataTable 
          id="dtList"
          value="#{auditoriaController.list}"
          var="record"
          paginator="true" 
          rows="10"
          paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
          rowsPerPageTemplate="10,50,100"
          selectionMode="single" 
          selection="#{auditoriaController.selected}" 
          rowKey="#{record.id}"
          reflow="true"> 
          <p:ajax 
            event="rowSelect" 
            listener="#{auditoriaController.onRowSelect}" 
            update=":main" />
          <p:column 
            headerText="#{bundle['auditoria.fecha']}"
            sortBy="#{record.fecha}">
            <h:outputText 
              value="#{record.fecha}">
              <f:convertDateTime 
                pattern="#{bundle['pattern.default.datetime']}"/>
            </h:outputText>
          </p:column>
          <p:column 
            headerText="#{bundle['auditoria.tabla']}"
            sortBy="#{record.tabla}">
            <h:outputText 
              value="#{record.tabla}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['auditoria.operacion']}"
            sortBy="#{record.operacion}">
            <h:outputText 
              value="#{record.operacion}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['auditoria.usuario']}"
            sortBy="#{record.usuario}">
            <h:outputText 
              value="#{record.usuario}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['auditoria.maquina']}"
            sortBy="#{record.maquina}">
            <h:outputText 
              value="#{record.maquina}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['auditoria.ip']}"
            sortBy="#{record.ip}">
            <h:outputText 
              value="#{record.ip}"/>
          </p:column>
        </p:dataTable>
      </h:form>
      <h:form
        id="frmDetail"
        prependId="false"
        rendered="#{auditoriaController.showDetails}">
        <h:outputText 
          value="#{bundle['auditoria.title.detail']}"/>
        <p:separator />
        <p:panel
          id="pnlDetails">
          <p:panelGrid
            columns="2"
            layout="grid" 
            columnClasses="ui-grid-col-2,ui-grid-col-10" 
            styleClass="ui-panelgrid-blank">
            <!-- fecha -->
            <p:outputLabel
              for="fecha"
              value="#{bundle['auditoria.fecha']}"/>
            <h:panelGroup>
              <h:outputText
                id="fecha"
                value="#{auditoriaController.selected.fecha}">
                <f:convertDateTime 
                  pattern="#{bundle['pattern.default.datetime']}"/>
              </h:outputText>
              <p:message
                for="fecha"/>
            </h:panelGroup>
            <!-- tabla -->
            <p:outputLabel
              for="tabla"
              value="#{bundle['auditoria.tabla']}"/>
            <h:panelGroup>
              <h:outputText
                id="tabla"
                value="#{auditoriaController.selected.tabla}"/>
              <p:message
                for="tabla"/>
            </h:panelGroup>
            <!-- operacion -->
            <p:outputLabel
              for="operacion"
              value="#{bundle['auditoria.operacion']}"/>
            <h:panelGroup>
              <h:outputText
                id="operacion"
                value="#{auditoriaController.selected.operacion}"/>
              <p:message
                for="operacion"/>
            </h:panelGroup>
            <!-- valorAnterior -->
            <p:outputLabel
              for="valorAnterior"
              value="#{bundle['auditoria.valor.anterior']}"/>
            <h:panelGroup>
              <h:outputText
                id="valorAnterior"
                value="#{auditoriaController.selected.valorAnterior}"/>
              <p:message
                for="valorAnterior"/>
            </h:panelGroup>
            <!-- valorNuevo -->
            <p:outputLabel
              for="valorNuevo"
              value="#{bundle['auditoria.valor.nuevo']}"/>
            <h:panelGroup>
              <h:outputText
                id="valorNuevo"
                value="#{auditoriaController.selected.valorNuevo}"/>
              <p:message
                for="valorNuevo"/>
            </h:panelGroup>
            <!-- usuario -->
            <p:outputLabel
              for="usuario"
              value="#{bundle['auditoria.usuario']}"/>
            <h:panelGroup>
              <h:outputText
                id="usuario"
                value="#{auditoriaController.selected.usuario}"/>
              <p:message
                for="usuario"/>
            </h:panelGroup>
            <!-- maquina -->
            <p:outputLabel
              for="maquina"
              value="#{bundle['auditoria.maquina']}"/>
            <h:panelGroup>
              <h:outputText
                id="maquina"
                value="#{auditoriaController.selected.maquina}"/>
              <p:message
                for="maquina"/>
            </h:panelGroup>
            <!-- ip -->
            <p:outputLabel
              for="fecha"
              value="#{bundle['auditoria.ip']}"/>
            <h:panelGroup>
              <h:outputText
                id="ip"
                value="#{auditoriaController.selected.ip}"/>
              <p:message
                for="ip"/>
            </h:panelGroup>
          </p:panelGrid>
          <f:facet
            name="footer">
            <p:panelGrid
              id="tbDetails"
              columns="12"
              layout="grid" 
              columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
              styleClass="ui-panelgrid-blank">
              <p:commandButton 
                value="#{bundle['commons.btn.back']}"
                title="#{bundle['commons.btn.back']}"
                icon="ui-icon-arrowreturn-1-w"
                actionListener="#{auditoriaController.onBack()}"
                update=":main"/>
            </p:panelGrid>
          </f:facet>
        </p:panel>
      </h:form>
    </p:panel>
  </ui:define>
</ui:composition>