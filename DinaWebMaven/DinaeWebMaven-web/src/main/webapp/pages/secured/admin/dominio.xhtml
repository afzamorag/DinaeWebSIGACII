<!DOCTYPE html>
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    template="/templates/plantillaPrincipal.xhtml">
    <ui:define
        name="content">
        <p:panel 
            id="main"
            styleClass="ui-fluid">
            <h:form
                id="frmlist"
                prependId="false"
                rendered="#{dominioController.showList}">
                <h:outputText 
                    value="#{bundle['dominio.title.list']}"/>
                <p:separator />
                <p:panel
                    id="pnlbtns">
                    <p:panelGrid
                        columns="6"
                        layout="grid" 
                        columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
                        styleClass="ui-panelgrid-blank">
                        <p:commandButton 
                            id="btnCreate" 
                            value="#{bundle['commons.btn.new']}"
                            title="#{bundle['commons.btn.new']}"
                            icon="ui-icon-document"
                            actionListener="#{dominioController.onCreate()}"
                            update=":main"/>
                        <p:commandButton 
                            value="#{bundle['commons.btn.refresh']}"
                            title="#{bundle['commons.btn.refresh']}"
                            icon="ui-icon-refresh"
                            actionListener="#{dominioController.loadList()}"
                            disabled="#{dominioController.editable}"
                            update="dtList"/>
                    </p:panelGrid>
                </p:panel>
                <p:dataTable 
                    id="dtList"
                    value="#{dominioController.list}"
                    var="record"
                    paginator="true"
                    paginatorPosition="bottom"
                    rows="10"
                    selectionMode="single" 
                    selection="#{dominioController.selected}" 
                    rowKey="#{record.id}"
                    reflow="true"
                    paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                    rowsPerPageTemplate="10,50,100"
                    style="font-size: smaller"> 
                    <p:ajax 
                        event="rowSelect" 
                        listener="#{dominioController.onRowSelect}" 
                        update=":main" />
                    <p:column 
                        headerText="#{bundle['dominio.tipo']}"
                        sortBy="#{record.tipo.nombre}"
                        filterMatchMode="contains"
                        filterBy="#{record.tipo.nombre}">
                        <h:outputText 
                            value="#{record.tipo.nombre}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['dominio.nombre']}"
                        sortBy="#{record.nombre}">
                        <h:outputText 
                            value="#{record.nombre}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['dominio.descripcion']}"
                        sortBy="#{record.descripcion}">
                        <h:outputText 
                            value="#{record.descripcion}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['dominio.vigente']}"
                        sortBy="#{record.vigente}">
                        <h:outputText 
                            value="#{record.vigente ? bundle['commons.lbl.yes'] : bundle['commons.lbl.no']}"/>
                    </p:column>
                </p:dataTable>
            </h:form>
            <h:form
                id="frmDetail"
                prependId="false"
                rendered="#{dominioController.showDetails}">
                <h:outputText 
                    value="#{bundle['dominio.title.detail']}"/>
                <p:separator />
                <p:panel
                    id="pnlDetails">
                    <p:panelGrid
                        columns="2"
                        layout="grid" 
                        columnClasses="ui-grid-col-2,ui-grid-col-10" 
                        styleClass="ui-panelgrid-blank">
                        <!-- tipo -->
                        <p:outputLabel
                            for="tipo"
                            value="#{bundle['dominio.tipo']}"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{dominioController.selected.tipo.nombre}"
                                rendered="#{!dominioController.editable}"/>
                            <p:selectOneMenu 
                                id="tipo" 
                                value="#{dominioController.selected.tipo}" 
                                converter="dominioTipoConverter"
                                required="true"
                                rendered="#{dominioController.editable}">
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{appController.tiposDominios}" 
                                    var="tipo" 
                                    itemLabel="#{tipo.nombre}" 
                                    itemValue="#{tipo}" />
                            </p:selectOneMenu>              
                            <p:message
                                for="tipo"/>
                        </h:panelGroup>
                        <!-- nombre -->
                        <p:outputLabel
                            for="nombre"
                            value="#{bundle['dominio.nombre']}"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{dominioController.selected.nombre}"
                                rendered="#{!dominioController.editable}"/>
                            <p:inputText
                                id="nombre"
                                value="#{dominioController.selected.nombre}"
                                required="true"
                                rendered="#{dominioController.editable}"/>
                            <p:message
                                for="nombre"/>
                        </h:panelGroup>
                        <!-- descripcion -->
                        <p:outputLabel
                            for="descripcion"
                            value="#{bundle['dominio.descripcion']}"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{dominioController.selected.descripcion}"
                                rendered="#{!dominioController.editable}"/>
                            <p:inputTextarea
                                id="descripcion"
                                value="#{dominioController.selected.descripcion}"
                                required="false"
                                rendered="#{dominioController.editable}"/>
                            <p:message
                                for="descripcion"/>
                        </h:panelGroup>
                        <!-- vigente -->
                        <p:outputLabel
                            for="vigente"
                            value="#{bundle['dominio.vigente']}"/>
                        <h:panelGroup>
                            <h:outputText 
                                value="#{dominioController.selected.vigente ? bundle['commons.lbl.yes'] : bundle['commons.lbl.no']}"
                                rendered="#{!dominioController.editable}"/>
                            <p:selectBooleanButton 
                                id="vigente" 
                                value="#{dominioController.selected.vigente}" 
                                required="true"
                                onLabel="#{bundle['commons.lbl.yes']}" 
                                offLabel="#{bundle['commons.lbl.no']}" 
                                style="width:60px" 
                                rendered="#{dominioController.editable}"/>
                            <p:message
                                for="vigente"/>
                        </h:panelGroup>
                    </p:panelGrid>
                    <f:facet
                        name="footer">
                        <p:panelGrid
                            id="tbDetails"
                            columns="12"
                            layout="grid" 
                            columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
                            styleClass="ui-panelgrid-blank">
                            <p:commandButton 
                                value="#{bundle['commons.btn.edit']}"
                                title="#{bundle['commons.btn.edit']}"
                                icon="ui-icon-pencil"
                                actionListener="#{dominioController.onEdit()}"
                                rendered="#{!dominioController.editable}"
                                update=":frmDetail"/>
                            <p:commandButton 
                                value="#{bundle['commons.btn.save']}"
                                title="#{bundle['commons.btn.save']}"
                                icon="ui-icon-disk"
                                actionListener="#{dominioController.onSave()}"
                                rendered="#{dominioController.editable}"
                                process="@form"
                                update=":frmDetail"/>
                            <p:commandButton 
                                value="#{bundle['commons.btn.cancel']}"
                                title="#{bundle['commons.btn.cancel']}"
                                icon="ui-icon-circle-close"
                                actionListener="#{dominioController.onCancel()}"
                                immediate="true"
                                rendered="#{dominioController.editable}"
                                update=":main"/>
                            <p:commandButton 
                                value="#{bundle['commons.btn.remove']}"
                                title="#{bundle['commons.btn.remove']}"
                                icon="ui-icon-trash"
                                actionListener="#{dominioController.onDelete()}"
                                immediate="true"
                                rendered="#{!dominioController.newRecord}"
                                update=":main">
                                <p:confirm 
                                    header="#{bundle['commons.cfmdlg.header']}" 
                                    message="#{bundle['commons.cfmdlg.remove.message']}" 
                                    icon="ui-icon-alert" />
                            </p:commandButton>
                            <p:commandButton 
                                value="#{bundle['commons.btn.back']}"
                                title="#{bundle['commons.btn.back']}"
                                icon="ui-icon-arrowreturn-1-w"
                                actionListener="#{dominioController.onBack()}"
                                rendered="#{!dominioController.editable}"
                                update=":main"/>
                        </p:panelGrid>
                    </f:facet>
                </p:panel>
            </h:form>
        </p:panel>
    </ui:define>
</ui:composition>