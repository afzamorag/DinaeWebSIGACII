<!DOCTYPE html>
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    template="/templates/plantillaPrincipal.xhtml">
    <ui:define
        name="content">
        <p:panel 
            id="main"
            styleClass="ui-fluid">
            <h:form
                id="frmList"
                prependId="false"
                rendered="#{sieduEventoEscuelaController.showList}"> 
                <h:outputText 
                    value="#{bundle['siedueventoescuela.title']}"/>
                <p:separator />
                <p:panel>
                    <p:panelGrid
                        id="pnlfiltro"
                        layout="grid" 
                        columns="2"
                        columnClasses="ui-grid-col-2,ui-grid-col-10" 
                        styleClass="ui-panelgrid-blank">
                        <!-- vigencia -->
                        <p:outputLabel
                            for="fltvigencia"
                            value="#{bundle['vigencia']}"/>
                        <h:panelGroup>
                            <p:selectOneMenu                             
                                value="#{sieduEventoEscuelaController.eventoEscuelaFiltro.vigencia}"               
                                required="true"
                                id="fltvigencia">
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{sieduEventoEscuelaController.vigencias}" 
                                    var="vigencia" 
                                    itemLabel="#{vigencia.vigencia}" 
                                    itemValue="#{vigencia.vigencia}"/>
                            </p:selectOneMenu>
                            <p:message
                                for="fltvigencia"/>
                        </h:panelGroup>
                        <p:outputLabel   
                            for="fltescuela"
                            value="#{bundle['escuela']}"
                            rendered="#{sieduEventoEscuelaController.validaRol}"/>
                        <h:panelGroup
                            rendered="#{sieduEventoEscuelaController.validaRol}">
                            <p:selectOneMenu                            
                                value="#{sieduEventoEscuelaController.eventoEscuelaFiltro.capaUdeEscu}"               
                                required="#{!sieduEventoEscuelaController.validaRol}" 
                                id="fltescuela"
                                filter="true"
                                filterMatchMode="contains">
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{appController.escuelas()}" 
                                    var="escuela" 
                                    itemLabel="#{escuela.descripcionDependencia}" 
                                    itemValue="#{escuela.consecutivo}"/>
                            </p:selectOneMenu>
                            <p:message
                                for="fltescuela"/>
                        </h:panelGroup>
                        <p:outputLabel                        
                            value="#{bundle['modalidad']}"/>
                        <h:panelGroup>
                            <p:selectOneMenu                            
                                value="#{sieduEventoEscuelaController.eventoEscuelaFiltro.idModalidad}">
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{sieduEventoEscuelaController.modalidad}" 
                                    var="modalidad" 
                                    itemLabel="#{modalidad.nombre}" 
                                    itemValue="#{modalidad.id}"/>
                            </p:selectOneMenu>
                        </h:panelGroup>
                        <p:outputLabel                        
                            value="#{bundle['nivelacademico']}"/>
                        <h:panelGroup>
                            <p:selectOneMenu                            
                                value="#{sieduEventoEscuelaController.nivelAcademico}">
                                <p:ajax 
                                    process ="@this"
                                    update="listaPrograma" 
                                    listener="#{appController.obtenerCarreras(sieduEventoEscuelaController.nivelAcademico)}"/>
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{sieduEventoEscuelaController.listNivelAcademico}" 
                                    var="nivelAcademico" 
                                    itemLabel="#{nivelAcademico.descripcion}" 
                                    itemValue="#{nivelAcademico.idNivelAcademico}"/>
                            </p:selectOneMenu>
                        </h:panelGroup>
                        <p:outputLabel                        
                            value="#{bundle['programa']}"/>
                        <h:panelGroup>
                            <p:selectOneMenu
                                id="listaPrograma"
                                value="#{sieduEventoEscuelaController.eventoEscuelaFiltro.idCarrera}"           
                                filter="true"
                                filterMatchMode="contains">                      
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{appController.obtenerCarreras(sieduEventoEscuelaController.nivelAcademico)}" 
                                    var="programa" 
                                    itemLabel="#{programa.descripcion}" 
                                    itemValue="#{programa.carrerasPK.idCarrera}"/>
                            </p:selectOneMenu>
                        </h:panelGroup>
                    </p:panelGrid>
                    <f:facet
                        name="footer">
                        <p:panelGrid
                            columns="2"
                            layout="grid" 
                            columnClasses="ui-grid-col-2, ui-grid-col-10" 
                            styleClass="ui-panelgrid-blank">                            
                            <p:commandButton 
                                id="btnCreate"
                                value="#{bundle['commons.btn.find']}"
                                title="#{bundle['commons.btn.find']}"
                                icon="ui-icon-search"
                                actionListener="#{sieduEventoEscuelaController.findByFilter()}"
                                update=":main"
                                style="border: none"/>             
                        </p:panelGrid>
                    </f:facet>
                </p:panel>
                <p:dataTable 
                    id="dtListMetas"
                    value="#{sieduEventoEscuelaController.list}"
                    var="record"
                    paginator="true" 
                    paginatorPosition="bottom"
                    rows="50"
                    selectionMode="single" 
                    selection="#{sieduEventoEscuelaController.selected}" 
                    rowKey="#{record.eveeEvee}"
                    reflow="true"
                    style="font-size: smaller; margin-top: 10px"
                    paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                    rowsPerPageTemplate="10,50,100"> 
                    <p:ajax 
                        event="rowSelect" 
                        listener="#{sieduEventoEscuelaController.onRowSelect}" 
                        update=":main" />
                    <p:column 
                        headerText="#{bundle['programa']}"
                        sortBy="#{record.eveeCapa.carrera.descripcion}"
                        filterMatchMode="contains"
                        filterBy="#{record.eveeCapa.carrera.descripcion}">
                        <h:outputText 
                            value="#{record.eveeCapa.carrera.descripcion}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['estrategia']}"
                        sortBy="#{record.eveeCapa.estrategia.nombre}"
                        filterMatchMode="contains"
                        style="width: 22%"
                        filterBy="#{record.eveeCapa.estrategia.nombre}">
                        <h:outputText 
                            value="#{record.eveeCapa.estrategia.nombre}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['siedueventoescuela.trimestre']}"
                        sortBy="#{record.eveeTrimes}"
                        style="text-align: center; width: 6%"
                        filterMatchMode="contains"
                        filterBy="#{record.eveeTrimes}">
                        <h:outputText 
                            value="#{record.eveeTrimes}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['siedueventoescuela.nroevento']}"
                        sortBy="#{record.eveeNroEvento}"
                        style="text-align: center; width: 8%">
                        <h:outputText 
                            value="#{record.eveeNroEvento}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['siedueventoescuela.fechainicio']}"
                        sortBy="#{record.eveeFechaini}"
                        style="text-align: center; width: 8%">
                        <h:outputText 
                            value="#{record.eveeFechaini}">
                            <f:convertDateTime 
                                type="date" 
                                pattern="#{bundle['pattern.default.date']}"/>
                        </h:outputText>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['siedueventoescuela.fechafin']}"
                        sortBy="#{record.eveeFechafin}"
                        style="text-align: center; width: 8%">
                        <h:outputText 
                            value="#{record.eveeFechafin}">
                            <f:convertDateTime 
                                type="date" 
                                pattern="#{bundle['pattern.default.date']}"/>
                        </h:outputText>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['siedueventoescuela.cerrado']}"
                        sortBy="#{record.eveeCerrado}"
                        style="text-align: center; width: 6%"
                        filterMatchMode="contains"
                        filterBy="#{record.eveeCerrado}">
                        <h:outputText 
                            value="#{record.eveeCerrado}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['capacitacion.presupuesto']}"
                        sortBy="#{record.eveeCapa.manejaPresupuesto}"
                        style="text-align: center; width: 8%"
                        filterMatchMode="contains"
                        filterBy="#{record.eveeCapa.manejaPresupuesto}">
                        <h:outputText 
                            value="#{record.eveeCapa.manejaPresupuesto}"/>
                    </p:column>
                </p:dataTable>
            </h:form>            
            <p:panel         
                id="pnlDetail"
                rendered="#{sieduEventoEscuelaController.showDetails}">
                <h:outputText 
                    value="#{bundle['siedueventoescuela.title']}"/>
                <p:separator />        
                <p:tabView 
                    id="tvDatos">
                    <p:tab 
                        id="tbdatosevento"
                        title="#{bundle['siedueventoescuela.tab.general']}">              
                        <ui:include src="desarrollo_evento_escuela.xhtml"/>               
                    </p:tab> 
                    <p:tab
                        id="tbconvocatoriaevento"
                        title="#{bundle['siedueventoescuela.tab.convocatoria']}"
                        rendered="#{!sieduEventoEscuelaController.renderTabView}">              
                        <ui:include src="convocatoria_evento_escuela.xhtml"/>               
                    </p:tab>
                    <p:tab
                        id="tbdocenteevento"
                        title="#{bundle['siedueventoescuela.tab.docente']}"
                        rendered="#{!sieduEventoEscuelaController.renderTabView}">              
                        <ui:include src="docente_evento_escuela.xhtml"/>               
                    </p:tab> 
                    <p:tab
                        id="tbparticipanteevento"
                        title="#{bundle['siedueventoescuela.tab.participante']}"
                        rendered="#{!sieduEventoEscuelaController.renderTabView}">              
                        <ui:include src="participante_evento_escuela.xhtml"/>               
                    </p:tab>
                    <p:tab
                        id="tbinasistenteevento"
                        title="#{bundle['siedueventoescuela.tab.inasistencia']}"
                        rendered="#{!sieduEventoEscuelaController.renderTabView}">              
                        <ui:include src="inasistencia_evento_escuela.xhtml"/>               
                    </p:tab>
                    <p:tab
                        id="tbevaluacvionevento"
                        title="#{bundle['siedueventoescuela.tab.evaluacion']}"
                        rendered="#{!sieduEventoEscuelaController.renderTabView}">              
                        <ui:include src="evaluacion_evento.xhtml"/>               
                    </p:tab>
                    <!--p:tab
                      id="tbcertificacionevento"
                      title="#{bundle['siedueventoescuela.tab.certificacion']}"
                      rendered="#{!sieduEventoEscuelaController.renderTabView}">              
                      <ui:include src="certificacion_evento_escuela.xhtml"/>               
                    </p:tab-->
                </p:tabView>   
            </p:panel>

        </p:panel>
    </ui:define>
</ui:composition>