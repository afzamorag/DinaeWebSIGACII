<!DOCTYPE html>
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">
    <p:panel>
        <h:form
            id="frmDatosEvento"
            prependId="false">
            <p:panel 
                id="mainDatosEvento">
                <p:panelGrid
                    id="pnlInfoDetalle"
                    layout="grid" 
                    columns="4"
                    columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4" 
                    styleClass="ui-panelgrid-blank">
                    <p:outputLabel                       
                        value="#{bundle['siedueventoescuela.title.nombrePrograma']}:"
                        styleClass="negrilla"/>
                    <h:outputText 
                        value="#{sieduEventoEscuelaController.selected.eveeCapa.carrera.descripcion}"                
                        styleClass="negrilla"/>
                    <p:outputLabel                       
                        value="#{bundle['siedueventoescuela.title.codMoodle']}:"
                        styleClass="negrilla"
                        rendered="#{sieduEventoEscuelaController.selected.eveeEven.dominioModalidad.id != 8}"/>
                    <h:outputText                 
                        value="#{sieduEventoEscuelaController.selected.eveeEven.carrera.carrerasPK.idCarrera}_C_#{sieduEventoEscuelaController.selected.eveeEvee}"               
                        styleClass="negrilla"
                        rendered="#{sieduEventoEscuelaController.selected.eveeEven.dominioModalidad.id != 8}"/>
                    <p:outputLabel                       
                        value="#{bundle['siedueventoescuela.title.codEvento']}:"
                        styleClass="negrilla"
                        rendered="#{sieduEventoEscuelaController.selected.eveeEven.dominioModalidad.id == 8}"/>
                    <h:outputText                 
                        value="#{sieduEventoEscuelaController.selected.eveeEvee}"               
                        styleClass="negrilla"
                        rendered="#{sieduEventoEscuelaController.selected.eveeEven.dominioModalidad.id == 8}"/>
                    <p:outputLabel   
                        for="lstunidaddee"
                        value="#{bundle['siedueventoescuela.unidad']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveeUdeUdepe.descripcionDependencia}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>
                        <p:selectOneMenu                            
                            value="#{sieduEventoEscuelaController.selected.eveeUdeUdepe}"               
                            required="true"
                            filter="true"
                            converter="unidadDependenciaConverter"
                            filterMatchMode="contains"
                            id="lstunidaddee"
                            rendered="#{sieduEventoEscuelaController.editable}">
                            <f:selectItem 
                                noSelectionOption="true"/>
                            <f:selectItems 
                                value="#{sieduEventoEscuelaController.unidades}" 
                                var="unidad" 
                                itemLabel="#{unidad.descripcionDependencia}" 
                                itemValue="#{unidad}"/>
                        </p:selectOneMenu>
                        <p:message
                            for="lstunidaddee"/>
                    </h:panelGroup>
                    <p:outputLabel                        
                        for="lstrecursodee" 
                        value="#{bundle['siedueventoescuela.recurso']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>          
                        <h:outputText
                            value="#{sieduEventoEscuelaController.recurso}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>
                        <p:selectOneMenu                            
                            id="lstrecursodee" 
                            value="#{sieduEventoEscuelaController.selected.eveeDomFinancia}"  
                            required="true"
                            rendered="#{sieduEventoEscuelaController.editable}">
                            <f:selectItem 
                                noSelectionOption="true"/>
                            <f:selectItems 
                                value="#{sieduEventoEscuelaController.recursoFinancia}" 
                                var="recursos" 
                                itemLabel="#{recursos.nombre}" 
                                itemValue="#{recursos.id}"/>
                        </p:selectOneMenu>
                        <p:message
                            for="lstrecursodee"/>
                    </h:panelGroup>
                    <p:outputLabel
                        for="lstentidaddee"
                        value="#{bundle['siedueventoescuela.entidad']}"
                        styleClass="negrilla"
                        rendered="#{(!sieduEventoEscuelaController.contrato or !sieduEventoEscuelaController.externo) and sieduEventoEscuelaController.editable}"/>
                    <h:panelGroup
                        rendered="#{(!sieduEventoEscuelaController.contrato or !sieduEventoEscuelaController.externo) and sieduEventoEscuelaController.editable}">
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveeEnti.entiNombre}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>
                        <p:selectOneMenu                             
                            value="#{sieduEventoEscuelaController.selected.eveeEnti}"  
                            converter="sieduEntidadConverter" 
                            required="#{!sieduEventoEscuelaController.externo}"             
                            id="lstentidaddee"                            
                            rendered="#{(!sieduEventoEscuelaController.contrato or !sieduEventoEscuelaController.externo) and sieduEventoEscuelaController.editable}">
                            <f:selectItem 
                                noSelectionOption="true"/>
                            <f:selectItems 
                                value="#{sieduEntidadController.list}" 
                                var="entidad" 
                                itemLabel="#{entidad.entiNombre}" 
                                itemValue="#{entidad}"/>
                        </p:selectOneMenu>
                        <p:message
                            for="lstentidaddee"/>
                    </h:panelGroup>
                    <p:outputLabel           
                        for="pptoPpto"
                        value="#{bundle['siedueventoescuela.contrato']}"
                        styleClass="negrilla"
                        rendered="#{!sieduEventoEscuelaController.contrato and sieduEventoEscuelaController.editable}" />
                    <h:panelGroup
                        rendered="#{!sieduEventoEscuelaController.contrato and sieduEventoEscuelaController.editable}">
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveePpto.nroContrato}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>
                        <p:selectOneMenu
                            id="pptoPpto"
                            value="#{sieduEventoEscuelaController.selected.eveePpto}"           
                            filter="true"
                            converter="sieduPresupuestoConverter"
                            filterMatchMode="contains"
                            required="#{!sieduEventoEscuelaController.contrato}"                             
                            rendered="#{!sieduEventoEscuelaController.contrato and sieduEventoEscuelaController.editable}" >
                            <f:selectItem 
                                noSelectionOption="true"/>
                            <f:selectItems 
                                value="#{presupuestoController.onLoadPresupuestosEvento()}" 
                                var="contratos" 
                                itemLabel="#{contratos.nroContrato}" 
                                itemValue="#{contratos}" />
                        </p:selectOneMenu>
                        <p:message
                            for="pptoPpto"/>
                    </h:panelGroup>
                    <p:outputLabel                        
                        id="lblcostodee"
                        for="iptcostodee" 
                        value="#{bundle['siedueventoescuela.costo']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveeCostoCapa}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>
                        <p:inputText 
                            id="iptcostodee" 
                            value="#{sieduEventoEscuelaController.selected.eveeCostoCapa}" 
                            required="true"
                            rendered="#{sieduEventoEscuelaController.editable}">
                            <p:ajax
                                event="blur"
                                process="@this"
                                update="costoEventomsg iptcostodee lblcostodee"/>
                            <f:validateLongRange
                                minimum="0"/>
                        </p:inputText>
                        <p:message
                            id="costoEventomsg"
                            for="iptcostodee"/>
                    </h:panelGroup>
                    <p:outputLabel                        
                        for="lstconveniodee" 
                        value="#{bundle['siedueventoescuela.convenio']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveeConv.convNombre}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>
                        <p:selectOneMenu
                            id="lstconveniodee"
                            value="#{sieduEventoEscuelaController.selected.eveeConv}"           
                            filter="true"
                            filterMatchMode="contains"
                            converter="sieduConvenioConverter"
                            required="false"
                            rendered="#{sieduEventoEscuelaController.editable}">                      
                            <f:selectItem 
                                noSelectionOption="true"/>
                            <f:selectItems 
                                value="#{sieduConvenioController.list}" 
                                var="convenio" 
                                itemLabel="#{convenio.convNombre}" 
                                itemValue="#{convenio}"/>
                        </p:selectOneMenu>
                        <p:message
                            for="lstconveniodee"/>
                    </h:panelGroup>
                    <p:outputLabel
                        id="fechaIniciallbl"
                        for="fechaInicial"
                        value="#{bundle['siedueventoescuela.fechainicio']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveeFechaini}"
                            rendered="#{!sieduEventoEscuelaController.editable}">
                            <f:convertDateTime type="date" pattern="#{bundle['pattern.default.date']}"/>
                        </h:outputText>
                        <p:calendar 
                            id="fechaInicial" 
                            value="#{sieduEventoEscuelaController.selected.eveeFechaini}"
                            pattern="#{bundle['pattern.default.date']}"
                            readonlyInput="true"
                            label="#{bundle['siedueventoescuela.fechainicio']}"
                            required="true"
                            mindate="#{sieduEventoEscuelaController.finicioRestrict}" 
                            maxdate="#{sieduEventoEscuelaController.ffinRestrict}" 
                            validator="fechaInicialValidador"
                            validatorMessage="#{bundle['commons.msg.error.validation.date.initial']}" 
                            rendered="#{sieduEventoEscuelaController.editable}">              
                            <p:ajax 
                                event="dateSelect" 
                                update="fechaIniciallbl fechaInicial fechaInicialmsg fechaFinallbl fechaFinal fechaFinalmsg"
                                listener="#{sieduEventoEscuelaController.minEndDateSelectEvent()}"/>
                            <f:attribute 
                                name="fechaFinal" 
                                value="#{sieduEventoEscuelaController.selected.eveeFechafin}"/>
                        </p:calendar>
                        <p:message
                            id="fechaInicialmsg"
                            for="fechaInicial"/>
                    </h:panelGroup>
                    <p:outputLabel
                        id="fechaFinallbl"
                        for="fechaFinal"
                        value="#{bundle['siedueventoescuela.fechafin']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveeFechafin}"
                            rendered="#{!sieduEventoEscuelaController.editable}">
                            <f:convertDateTime type="date" pattern="#{bundle['pattern.default.date']}"/>
                        </h:outputText>
                        <p:calendar 
                            id="fechaFinal" 
                            value="#{sieduEventoEscuelaController.selected.eveeFechafin}"
                            pattern="#{bundle['pattern.default.date']}"
                            readonlyInput="true"
                            label="#{bundle['siedueventoescuela.fechafin']}"
                            required="true"
                            mindate="#{sieduEventoEscuelaController.finiMin}" 
                            maxdate="#{sieduEventoEscuelaController.ffinRestrict}" 
                            validator="fechaFinalValidador"
                            validatorMessage="#{bundle['commons.msg.error.validation.date.final']}" 
                            rendered="#{sieduEventoEscuelaController.editable}">              
                            <p:ajax 
                                event="dateSelect" 
                                update="fechaIniciallbl fechaInicial fechaInicialmsg fechaFinallbl fechaFinal fechaFinalmsg iptdiasdee"
                                listener="#{sieduEventoEscuelaController.totalDiasEvento()}"/>
                            <f:attribute 
                                name="fechaInicial" 
                                value="#{sieduEventoEscuelaController.selected.eveeFechaini}"/>
                        </p:calendar>              
                        <p:message
                            id="fechaFinalmsg"
                            for="fechaFinal"/>
                    </h:panelGroup>
                    <p:outputLabel
                        id="lbldiasdee"
                        for="iptdiasdee" 
                        value="#{bundle['siedueventoescuela.dias']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.eveeNroDias}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>                        
                        <p:selectOneMenu
                            id="iptdiasdee"
                            value="#{sieduEventoEscuelaController.selected.eveeNroDias}"                                                        
                            rendered="#{sieduEventoEscuelaController.editable}">                      
                            <f:selectItem 
                                noSelectionOption="true"/>
                            <f:selectItems 
                                value="#{sieduEventoEscuelaController.days}" 
                                var="day" 
                                itemLabel="#{day}" 
                                itemValue="#{day}"/>
                        </p:selectOneMenu>
                        <p:message
                            id="totalDiasmsg"
                            for="iptdiasdee"/> 
                    </h:panelGroup>
                    <p:outputLabel                        
                        for="lstciudaddee" 
                        value="#{bundle['siedueventoescuela.ciudad']}"
                        styleClass="negrilla"/>
                    <h:panelGroup>
                        <h:outputText
                            value="#{sieduEventoEscuelaController.selected.lugarGeografico.descMunicipio} - #{sieduEventoEscuelaController.selected.lugarGeografico.descDepartamento}"
                            rendered="#{!sieduEventoEscuelaController.editable}"/>
                        <p:selectOneMenu
                            id="lstciudaddee"
                            value="#{sieduEventoEscuelaController.selected.lugarGeografico}"
                            converter="lugarGeograficoConverter"
                            required="true"
                            filter="true"
                            filterMatchMode="contains"
                            rendered="#{sieduEventoEscuelaController.editable}">                      
                            <f:selectItem 
                                noSelectionOption="true"/>
                            <f:selectItems 
                                value="#{sieduEventoEscuelaController.ciudad}" 
                                var="municipio" 
                                itemLabel="#{municipio.descDepartamento} - #{municipio.descMunicipio}" 
                                itemValue="#{municipio}"/>
                        </p:selectOneMenu>
                        <p:message
                            for="lstciudaddee"/>
                    </h:panelGroup>
                </p:panelGrid>
                <p:separator />
                <p:panelGrid
                    id="pnlDatosParticipantes"
                    layout="grid" 
                    columns="6"
                    columnClasses="ui-grid-col-2, ui-grid-col-2, ui-grid-col-2, ui-grid-col-2, ui-grid-col-2, ui-grid-col-2" 
                    styleClass="ui-panelgrid-blank">
                    <h:outputText
                        value="#{bundle['siedueventoescuela.evaluacion.calificaciongeneral.lbl']}"
                        styleClass="negrilla"/>
                    <h:outputText
                        value="#{sieduEventoEscuelaController.selected.eveeCalificacionEvento}"/>
                    <h:outputText
                        value="#{bundle['siedueventoescuela.totalparticipantes']}"
                        styleClass="negrilla"/>                   
                    <h:outputText
                        value="#{sieduEventoEscuelaController.selected.eveeNroParticipantes}"/>
                    <h:outputText
                        value="#{bundle['siedueventoescuela.convocados']}"
                        styleClass="negrilla"/>
                    <h:outputText
                        value="#{sieduEventoEscuelaController.selected.eveeNroConvocados}"/>               
                    <h:outputText
                        value="#{bundle['siedueventoescuela.aprobados']}"
                        styleClass="negrilla"/>
                    <h:outputText
                        value="#{sieduEventoEscuelaController.selected.eveNroAprobados}"/>
                    <h:outputText
                        value="#{bundle['siedueventoescuela.noaprobados']}"
                        styleClass="negrilla"/>
                    <h:outputText
                        value="#{sieduEventoEscuelaController.selected.eveNroNoaprobados}"/>
                    <h:outputText
                        value="#{bundle['siedueventoescuela.desertados']}"
                        styleClass="negrilla"/>
                    <h:outputText
                        value="#{sieduEventoEscuelaController.selected.eveeNroDesertados}"/>                    
                </p:panelGrid>
                <f:facet
                    name="footer">
                    <p:panelGrid
                        columns="7"
                        >
                        <p:commandButton 
                            id="btnCreate"
                            value="#{bundle['commons.btn.save']}"
                            title="#{bundle['commons.btn.save']}"
                            icon="ui-icon-disk"
                            actionListener="#{sieduEventoEscuelaController.onSave()}"     
                            process=":tvDatos:mainDatosEvento"
                            update=":tvDatos"
                            rendered="#{sieduEventoEscuelaController.editable}"
                            style="border: none"/>                       
                        <p:commandButton
                            id="btnEdit"
                            value="#{bundle['commons.btn.edit']}"
                            title="#{bundle['commons.btn.edit']}"
                            icon="ui-icon-pencil"
                            actionListener="#{sieduEventoEscuelaController.onEdit()}"
                            process="@form"                                                        
                            update=":tvDatos"
                            rendered="#{!sieduEventoEscuelaController.editable and sieduEventoEscuelaController.selected.eveeCerrado.equals('NO')}"                            
                            style="border: none"/>
                        <p:commandButton
                            value="#{bundle['commons.btn.back']}"
                            title="#{bundle['commons.btn.back']}"
                            icon="ui-icon-arrowreturn-1-w"
                            actionListener="#{sieduEventoEscuelaController.onBack()}"
                            immediate="true"
                            update=":main"
                            style="border: none">
                            <p:ajax 
                                update="mainDatosEvento" 
                                resetValues="true" />
                        </p:commandButton>
                        <p:commandButton
                            value="#{bundle['commons.btn.closeEvent']}"
                            title="#{bundle['commons.btn.closeEvent']}"
                            rendered="#{sieduEventoEscuelaController.renderButtom}"
                            icon="ui-icon-locked"
                            actionListener="#{sieduEventoEscuelaController.onCloseEvento()}"
                            update=":tvDatos"
                            style="border: none">
                            <p:confirm 
                                header="#{bundle['commons.cfmdlg.header']}" 
                                message="#{bundle['siedueventoescuela.cfmdlg.closeevent.message']}" 
                                icon="ui-icon-alert" />            
                        </p:commandButton> 
                        <p:commandButton
                            value="#{bundle['commons.btn.openEvent']}"
                            title="#{bundle['commons.btn.openEvent']}"
                            icon="ui-icon-locked"
                            actionListener="#{sieduEventoEscuelaController.onOpenEvento()}"
                            disabled="#{!sieduEventoEscuelaController.loginFaces.perfilUsuarioDTO.validarRol(41)}"
                            rendered="#{!sieduEventoEscuelaController.renderButtom}"
                            update=":tvDatos"
                            style="border: none">
                            <p:confirm 
                                header="#{bundle['commons.cfmdlg.header']}" 
                                message="#{bundle['siedueventoescuela.cfmdlg.openevent.message']}" 
                                icon="ui-icon-alert" />
                        </p:commandButton>                       
                        <p:commandButton 
                            id="btnClear"
                            value="#{bundle['commons.btn.clear']}"
                            title="#{bundle['commons.btn.clear']}"
                            icon="ui-icon-disk"
                            actionListener="#{sieduEventoEscuelaController.limpiarFechas()}"     
                            process=":tvDatos:mainDatosEvento"
                            update=":tvDatos"                            
                            rendered="#{sieduEventoEscuelaController.editable}"
                            disabled="#{!sieduEventoEscuelaController.validaRol}"                            
                            style="border: none"/>
                        <p:commandButton
                            value="#{bundle['siedueventoescuela.title.moodle']}"
                            title="#{bundle['siedueventoescuela.title.moodle']}"
                            icon="fa-mortar-board"
                            actionListener="#{ sieduEventoEscuelaController.moodleMasivo()}"
                            immediate="true"
                            update=":main"
                            style="border: none"                            
                            rendered="#{!sieduEventoEscuelaController.editable}"
                            disabled="#{!sieduEventoEscuelaController.validaRolTelem}"
                            />
                    </p:panelGrid>
                </f:facet>
            </p:panel>
        </h:form>            
    </p:panel>
</ui:composition>