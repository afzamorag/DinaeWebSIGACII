<!DOCTYPE html>
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    template="/templates/plantillaPrincipal.xhtml">
    <ui:define
        name="content">
        <p:panel 
            id="main"
            styleClass="ui-fluid">
            <h:form
                id="frmlist"
                prependId="false"
                rendered="#{entidadController.showList}">
                <h:outputText 
                    value="#{bundle['entidad.titulo.lbl']}"/>
                <p:separator />
                <p:dataTable 
                    id="dtList"
                    value="#{entidadController.list}"
                    var="record"
                    paginator="true"
                    paginatorPosition="bottom"
                    rows="10"
                    selectionMode="single" 
                    selection="#{entidadController.selected}" 
                    rowKey="#{record.entiEnti}"
                    reflow="true"
                    paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                    rowsPerPageTemplate="10,50,100"
                    style="font-size: smaller">
                    <f:facet
                        name="header">
                        #{bundle['entidad.titulo.tbl']}
                    </f:facet>
                    <p:ajax 
                        event="rowSelect" 
                        listener="#{entidadController.onRowSelect}" 
                        update=":main" />
                    <p:column 
                        headerText="#{bundle['entidad.nombre.lbl']}"
                        sortBy="#{record.entiNombre}"
                        filterMatchMode="contains"
                        filterBy="#{record.entiNombre}"
                        style="width: 30%">
                        <h:outputText 
                            value="#{record.entiNombre}"/>
                    </p:column>                    
                    <p:column 
                        headerText="#{bundle['entidad.direccion.lbl']}"
                        style="width: 30%">
                        <h:outputText 
                            value="#{record.entiDireccion}"/>
                    </p:column>                    
                    <p:column 
                        headerText="#{bundle['entidad.paginaweb.lbl']}"
                        style="width: 30%">
                        <h:outputText 
                            value="#{record.entiPageWeb}"/>
                    </p:column>
                    <p:column 
                        headerText="#{bundle['entidad.telefono.lbl']}"
                        style="width: 10%">
                        <h:outputText 
                            value="#{record.entiTelefono}"/>
                    </p:column>
                </p:dataTable>
                <p:panel
                    id="pnlbtns">
                    <p:panelGrid
                        columns="6"
                        layout="grid" 
                        columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
                        styleClass="ui-panelgrid-blank">
                        <p:commandButton 
                            id="btnCreate" 
                            value="#{bundle['commons.btn.new']}"
                            title="#{bundle['commons.btn.new']}"
                            icon="ui-icon-document"
                            actionListener="#{entidadController.onCreate()}"
                            update=":main"
                            style="border: none"/>
                        <p:commandButton 
                            value="#{bundle['commons.btn.refresh']}"
                            title="#{bundle['commons.btn.refresh']}"
                            icon="ui-icon-refresh"
                            actionListener="#{entidadController.loadList()}"
                            disabled="#{entidadController.editable}"
                            update="dtList"
                            style="border: none"/>
                    </p:panelGrid>
                </p:panel>
            </h:form>
            <h:form
                id="frmDetail"
                prependId="false"
                rendered="#{entidadController.showDetails}">
                <h:outputText 
                    value="#{bundle['entidad.titulo.detalle.lbl']}"/>
                <p:separator />
                <p:panel
                    id="pnlDetails">
                    <p:panelGrid
                        columns="2"
                        layout="grid" 
                        columnClasses="ui-grid-col-2,ui-grid-col-10">
                        <f:facet
                            name="header">
                                #{bundle['entidad.datos.lbl']}
                        </f:facet>
                        <!--nombre-->
                        <p:outputLabel
                            for="nombre"
                            value="#{bundle['entidad.nombre.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{entidadController.selected.entiNombre}"
                                rendered="#{!entidadController.editable}"/>
                            <p:inputTextarea
                                id="nombre"
                                value="#{entidadController.selected.entiNombre}"
                                required="false"
                                rendered="#{entidadController.editable}"/>                            
                            <p:message
                                for="nombre"/>
                        </h:panelGroup>
                        <!--Tipo entidad -->
                        <p:outputLabel
                            for="tipoEntidad"
                            value="#{bundle['entidad.titulo.tipo.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{appController.descDominio(entidadController.selected.entiDomTipo)}"
                                rendered="#{!entidadController.editable}"/>
                            <p:selectOneMenu 
                                id="tipoEntidad" 
                                value="#{entidadController.selected.entiDomTipo}"                                 
                                required="true"
                                rendered="#{entidadController.editable}">
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{appController.loadTipoEntidad()}" 
                                    var="tipo" 
                                    itemLabel="#{tipo.nombre}" 
                                    itemValue="#{tipo.id}" />
                            </p:selectOneMenu>   
                            <p:message
                                for="tipoEntidad"/>                            
                        </h:panelGroup>
                        <!--Sector entidad -->
                        <p:outputLabel
                            for="sectorEntidad"
                            value="#{bundle['entidad.titulo.sector.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{appController.descDominio(entidadController.selected.entiDomSector)}"
                                rendered="#{!entidadController.editable}"/>
                            <p:selectOneMenu 
                                id="sectorEntidad" 
                                value="#{entidadController.selected.entiDomSector}"                                 
                                required="true"
                                rendered="#{entidadController.editable}">
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{appController.loadSectorEmpresa()}" 
                                    var="tipo" 
                                    itemLabel="#{tipo.nombre}" 
                                    itemValue="#{tipo.id}" />
                            </p:selectOneMenu>   
                            <p:message
                                for="sectorEntidad"/>                            
                        </h:panelGroup>
                        <!--País entidad -->
                        <p:outputLabel
                            for="paisEntidad"
                            value="#{bundle['entidad.pais.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{appController.getPais(entidadController.selected.entiLuggeo)}"
                                rendered="#{!entidadController.editable}"/>
                            <p:selectOneMenu 
                                id="paisEntidad" 
                                value="#{entidadController.idPais}"                                 
                                required="true"
                                rendered="#{entidadController.editable}"
                                filter="true"
                                filterMatchMode="contains">
                                <p:ajax 
                                    process="@this" 
                                    update="CiudadEntidad"/>
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{appController.paises}" 
                                    var="pais" 
                                    itemLabel="#{pais.descPais}" 
                                    itemValue="#{pais.codPais}"/>
                            </p:selectOneMenu>   
                            <p:message
                                for="paisEntidad"/>                            
                        </h:panelGroup>
                        <!-- Ciudad entidad -->
                        <p:outputLabel
                            for="CiudadEntidad"
                            value="#{bundle['entidad.ciudad.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{appController.getMunicipio(entidadController.selected.entiLuggeo)}"
                                rendered="#{!entidadController.editable}"/>
                            <p:selectOneMenu 
                                id="CiudadEntidad" 
                                value="#{entidadController.selected.entiLuggeo}"                                 
                                required="true"
                                rendered="#{entidadController.editable}"
                                filter="true"
                                filterMatchMode="contains">
                                <f:selectItem 
                                    noSelectionOption="true"/>
                                <f:selectItems 
                                    value="#{appController.municipios(entidadController.idPais)}" 
                                    var="municipio" 
                                    itemLabel="#{municipio.descDepartamento} - #{municipio.descMunicipio}" 
                                    itemValue="#{municipio.codMunicipio}" />
                            </p:selectOneMenu>   
                            <p:message
                                for="CiudadEntidad"/>                            
                        </h:panelGroup>
                         <!-- Direccion entidad -->
                        <p:outputLabel
                            for="direccionEntidad"
                            value="#{bundle['entidad.direccion.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{entidadController.selected.entiDireccion}"
                                rendered="#{!entidadController.editable}"/>
                            <p:inputTextarea
                                id="direccionEntidad"
                                value="#{entidadController.selected.entiDireccion}"
                                required="false"
                                rendered="#{entidadController.editable}"/>                            
                            <p:message
                                for="direccionEntidad"/>
                        </h:panelGroup>
                         <!-- Teléfono entidad -->
                        <p:outputLabel
                            for="TelefonoEntidad"
                            value="#{bundle['entidad.telefono.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{entidadController.selected.entiTelefono}"
                                rendered="#{!entidadController.editable}"/>
                            <p:inputTextarea
                                id="TelefonoEntidad"
                                value="#{entidadController.selected.entiTelefono}"
                                required="false"
                                rendered="#{entidadController.editable}"/>                            
                            <p:message
                                for="TelefonoEntidad"/>
                        </h:panelGroup>
                         <!-- Web entidad -->
                        <p:outputLabel
                            for="WebEntidad"
                            value="#{bundle['entidad.paginaweb.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{entidadController.selected.entiPageWeb}"
                                rendered="#{!entidadController.editable}"/>
                            <p:inputTextarea
                                id="WebEntidad"
                                value="#{entidadController.selected.entiPageWeb}"
                                required="false"
                                rendered="#{entidadController.editable}"/>                            
                            <p:message
                                for="WebEntidad"/>
                        </h:panelGroup>
                         <!-- Email entidad -->
                        <p:outputLabel
                            for="EmailEntidad"
                            value="#{bundle['entidad.email.lbl']}:"
                            styleClass="negrilla"/>
                        <h:panelGroup>
                            <h:outputText
                                value="#{entidadController.selected.entiEmail}"
                                rendered="#{!entidadController.editable}"/>
                            <p:inputTextarea
                                id="EmailEntidad"
                                value="#{entidadController.selected.entiEmail}"
                                required="false"
                                rendered="#{entidadController.editable}"/>                            
                            <p:message
                                for="EmailEntidad"/>
                        </h:panelGroup>
                    </p:panelGrid> 
                    <f:facet
                        name="footer">
                        <p:panelGrid
                            id="tbDetails"
                            columns="12"
                            layout="grid" 
                            columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
                            styleClass="ui-panelgrid-blank">
                            <p:commandButton 
                                value="#{bundle['commons.btn.edit']}"
                                title="#{bundle['commons.btn.edit']}"
                                icon="ui-icon-pencil"
                                actionListener="#{entidadController.onEdit()}"
                                rendered="#{!entidadController.editable}"
                                update=":frmDetail"
                                style="border: none"/>
                            <p:commandButton 
                                value="#{bundle['commons.btn.save']}"
                                title="#{bundle['commons.btn.save']}"
                                icon="ui-icon-disk"
                                actionListener="#{entidadController.onSave()}"
                                rendered="#{entidadController.editable}"
                                process="@form"
                                update=":frmDetail"
                                style="border: none"/>
                            <p:commandButton 
                                value="#{bundle['commons.btn.cancel']}"
                                title="#{bundle['commons.btn.cancel']}"
                                icon="ui-icon-circle-close"
                                actionListener="#{entidadController.onCancel()}"
                                immediate="true"
                                rendered="#{entidadController.editable}"
                                update=":main"
                                style="border: none"/>
                            <p:commandButton 
                                value="#{bundle['commons.btn.remove']}"
                                title="#{bundle['commons.btn.remove']}"
                                icon="ui-icon-trash"
                                actionListener="#{entidadController.onDelete()}"
                                immediate="true"
                                rendered="#{!entidadController.newRecord}"
                                update=":main"
                                style="border: none">
                                <p:confirm 
                                    header="#{bundle['commons.cfmdlg.header']}" 
                                    message="#{bundle['commons.cfmdlg.remove.message']}" 
                                    icon="ui-icon-alert" />
                            </p:commandButton>
                            <p:commandButton 
                                value="#{bundle['commons.btn.back']}"
                                title="#{bundle['commons.btn.back']}"
                                icon="ui-icon-arrowreturn-1-w"
                                actionListener="#{entidadController.onBack()}"
                                rendered="#{!entidadController.editable}"
                                update=":main"
                                style="border: none"/>
                        </p:panelGrid>
                    </f:facet>
                </p:panel>
            </h:form>
        </p:panel>
    </ui:define>
</ui:composition>