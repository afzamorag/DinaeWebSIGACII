<!DOCTYPE html>
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:p="http://primefaces.org/ui"
  template="/templates/plantillaPrincipal.xhtml">
  <ui:define
    name="content">
    <p:panel 
      id="main"
      styleClass="ui-fluid">
      <h:form
        id="frm"
        prependId="false">
        <h:outputText 
          value="#{bundle['capacitacion.title.detail']}"/>
        <p:separator />
        <p:panel
          id="pnl">
          <p:panelGrid
            columns="2"
            layout="grid" 
            columnClasses="ui-grid-col-2,ui-grid-col-10" 
            styleClass="ui-panelgrid-blank">
            <!-- vigencia -->
            <p:outputLabel
              for="vigencia"
              value="#{bundle['vigencia']}"/>
            <h:panelGroup>
              <h:outputText
                id="vigencia"
                value="#{presupuestoController.selected.pae.vigencia}"/>
              <p:message
                for="vigencia"/>
            </h:panelGroup>
            <!-- escuela -->
            <p:outputLabel
              for="escuela"
              value="#{bundle['escuela']}"/>
            <h:panelGroup>
              <h:outputText
                id="escuela"
                value="#{presupuestoController.selected.escuela.descripcionDependencia}"/>
              <p:message
                for="escuela"/>
            </h:panelGroup>
            <!-- nivelacademico -->
            <p:outputLabel
              for="nivelacademico"
              value="#{bundle['nivelacademico']}"/>
            <h:panelGroup>
              <h:outputText
                id="nivelacademico"
                value="#{presupuestoController.selected.carrera.nivelAcademico.descripcion}"/>
              <p:message
                for="nivelacademico"/>
            </h:panelGroup>
            <!-- carrera -->
            <p:outputLabel
              for="carrera"
              value="#{bundle['capacitacion.carrera']}"/>
            <h:panelGroup>
              <h:outputText
                id="carrera"
                value="#{presupuestoController.selected.carrera.descripcion}"/>
              <p:message
                for="carrera"/>
            </h:panelGroup>
            <!-- manejaPresupuesto -->
            <p:outputLabel
              for="manejaPresupuesto"
              value="#{bundle['capacitacion.presupuesto']}"/>
            <h:panelGroup>
              <h:outputText
                id="manejaPresupuesto"
                value="#{presupuestoController.selected.manejaPresupuesto}"/>
              <p:message
                for="manejaPresupuesto"/>
            </h:panelGroup>
            <!-- estado -->
            <p:outputLabel
              for="estado"
              value="#{bundle['capacitacion.estado']}"/>
            <h:panelGroup>
              <h:outputText
                id="estado"
                value="#{presupuestoController.selected.estado}"/>
              <p:message
                for="estado"/>
            </h:panelGroup>            
            <p:outputLabel 
              value="#{bundle['presupuesto.title.list']}"
              styleClass="toolbar-title"/>
            <h:panelGroup
              id="pnlpresupuestos">
              <p:panelGrid
                id="pnloptionspresupuestos"
                columns="6"
                layout="grid" 
                columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
                styleClass="ui-panelgrid-blank">
                <p:commandButton 
                  value="#{bundle['commons.btn.add']}" 
                  title="#{bundle['commons.btn.add']}"
                  actionListener="#{presupuestoController.onCreatePresupuesto()}"
                  rendered="#{presupuestoController.validaRol}"
                  update="dlgpresupuesto"/>
                <p:commandButton 
                  value="#{bundle['commons.btn.edit']}" 
                  title="#{bundle['commons.btn.edit']}"
                  actionListener="#{presupuestoController.onEditPresupuesto()}"
                  rendered="#{presupuestoController.validaRol}"
                  update="dlgpresupuesto"/>
                <p:commandButton 
                  value="#{bundle['commons.btn.remove']}"
                  title="#{bundle['commons.btn.remove']}"
                  icon="ui-icon-trash"
                  actionListener="#{presupuestoController.onDeletePresupuesto()}"
                  rendered="#{presupuestoController.validaRol}"
                  immediate="true"
                  update="pnlpresupuestos">
                  <p:confirm 
                    header="#{bundle['commons.cfmdlg.header']}" 
                    message="#{bundle['commons.cfmdlg.remove.message']}" 
                    icon="ui-icon-alert" />
                </p:commandButton>
              </p:panelGrid>
              <p:dataTable 
                id="dtpresupuestos"
                value="#{presupuestoController.selected.presupuestos}"
                var="presupuesto"
                selectionMode="single" 
                selection="#{presupuestoController.presupuesto}" 
                rowKey="#{presupuesto.id}"
                reflow="true"> 
                <p:ajax 
                  event="rowSelect" 
                  listener="#{presupuestoController.onRowSelectPresupuesto}"
                  disabled="#{!presupuestoController.enableRowSelectPresupuesto()}"
                  update="pnlpresupuestos" />
                <p:ajax 
                  event="rowUnselect" 
                  listener="#{presupuestoController.onRowUnselectPresupuesto}"
                  disabled="#{!presupuestoController.enableRowSelectPresupuesto()}"
                  update="pnlpresupuestos" />
                <p:column 
                  headerText="#{bundle['presupuesto.contrato.fecha']}"
                  sortBy="#{presupuesto.fechaContrato}">
                  <h:outputText 
                    value="#{presupuesto.fechaContrato}">
                    <f:convertDateTime 
                      pattern="#{bundle['pattern.default.date']}"/>
                  </h:outputText>
                </p:column>
                <p:column 
                  headerText="#{bundle['presupuesto.contrato.numero']}"
                  sortBy="#{presupuesto.nroContrato}">
                  <h:outputText 
                    value="#{presupuesto.nroContrato}">
                  </h:outputText>
                </p:column>
                <p:column 
                  headerText="#{bundle['presupuesto.contrato.valor']}"
                  sortBy="#{presupuesto.vlrContrato}">
                  <h:outputText 
                    value="#{presupuesto.vlrContrato}">
                  </h:outputText>
                </p:column>
                <p:column 
                  headerText="#{bundle['presupuesto.recurso']}"
                  sortBy="#{presupuesto.recurso.nombre}">
                  <h:outputText 
                    value="#{presupuesto.recurso.nombre}">
                  </h:outputText>
                </p:column>
              </p:dataTable>
            </h:panelGroup>
          </p:panelGrid>
          <f:facet
            name="footer">
            <p:panelGrid
              columns="12"
              layout="grid" 
              columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
              styleClass="ui-panelgrid-blank">
              <p:commandButton 
                value="#{bundle['commons.btn.back']}"
                title="#{bundle['commons.btn.back']}"
                icon="ui-icon-arrowreturn-1-w"
                action="#{presupuestoController.onBackToList()}"/>
            </p:panelGrid>
          </f:facet>
        </p:panel>
      </h:form>
    </p:panel>
    <p:dialog 
      id="dlgpresupuesto"
      widgetVar="dlgpresupuestowv" 
      visible="#{presupuestoController.showFormPresupuesto}"
      modal="true"
      width="800"
      closable="false"
      closeOnEscape="false"
      resizable="false"
      responsive="true" 
      draggable="false">
      <h:form
        id="frmpresupuesto"
        prependId="false">
        <p:panel
          id="pnlpresupuesto">
          <h:outputText 
            value="#{bundle['presupuesto.title.detail']}"/>
          <p:separator />
          <p:messages
            globalOnly="true"
            showDetail="true"/>
          <p:panelGrid
            columns="2"
            layout="grid" 
            columnClasses="ui-grid-col-4,ui-grid-col-8" 
            styleClass="ui-panelgrid-blank">
            <!-- fechaContrato -->
            <p:outputLabel
              id="fechaContratolbl"
              for="fechaContrato"
              value="#{bundle['presupuesto.contrato.fecha']}"/>
            <h:panelGroup>
              <p:calendar 
                id="fechaContrato" 
                value="#{presupuestoController.presupuesto.fechaContrato}"
                pattern="#{bundle['pattern.default.date']}"
                readonlyInput="true"
                mindate="#{presupuestoController.minDateContrato}"
                maxdate="#{presupuestoController.maxDateContrato}"
                required="true">   
                <p:ajax
                  event="dateSelect"
                  update="fechaContratolbl fechaContrato fechaContratomsg"/>
              </p:calendar>
              <p:message
                id="fechaContratomsg"
                for="fechaContrato"/>
            </h:panelGroup>
            <!-- recurso -->
            <p:outputLabel
              id="recursolbl"
              for="recurso"
              value="#{bundle['presupuesto.recurso']}"/>
            <h:panelGroup>
              <p:selectOneMenu 
                id="recurso" 
                value="#{presupuestoController.presupuesto.recurso}" 
                converter="dominioConverter"
                required="true">
                <p:ajax
                  process="@this"
                  update="recursolbl recurso recursomsg"/>
                <f:selectItem 
                  noSelectionOption="true"/>
                <f:selectItems 
                  value="#{presupuestoController.recursos}" 
                  var="recurso" 
                  itemLabel="#{recurso.nombre}" 
                  itemValue="#{recurso}" />
              </p:selectOneMenu>              
              <p:message
                id="recursomsg"
                for="recurso"/>
            </h:panelGroup>
            <!-- nroContrato -->
            <p:outputLabel
              id="nroContratolbl"
              for="nroContrato"
              value="#{bundle['presupuesto.contrato.numero']}"/>
            <h:panelGroup>
              <p:inputText
                id="nroContrato"
                value="#{presupuestoController.presupuesto.nroContrato}"
                required="true">
                <p:ajax
                  process="@this"
                  update="nroContratolbl nroContrato nroContratomsg"/>
              </p:inputText>
              <p:message
                id="nroContratomsg"
                for="nroContrato"/>
            </h:panelGroup>
            <!-- vlrContrato -->
            <p:outputLabel
              id="vlrContratolbl"
              for="vlrContrato"
              value="#{bundle['presupuesto.contrato.valor']}"/>
            <h:panelGroup>
              <p:inputText
                id="vlrContrato"
                value="#{presupuestoController.presupuesto.vlrContrato}"
                required="true">
                <p:ajax
                  process="@this"
                  update="vlrContratolbl vlrContrato vlrContratomsg"/>
                <f:convertNumber 
                  currencySymbol="#" 
                  maxIntegerDigits="12" 
                  maxFractionDigits="2" 
                  pattern="#{bundle['pattern.default.currency']}"/>
                <f:validateDoubleRange
                  minimum="1"/>
              </p:inputText>
              <p:message
                id="vlrContratomsg"
                for="vlrContrato"/>
            </h:panelGroup>
          </p:panelGrid>
          <f:facet
            name="footer">
            <p:panelGrid
              columns="12"
              layout="grid" 
              columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2,ui-grid-col-2" 
              styleClass="ui-panelgrid-blank">
              <p:commandButton 
                value="#{bundle['commons.btn.save']}"
                title="#{bundle['commons.btn.save']}"
                icon="ui-icon-disk"
                actionListener="#{presupuestoController.onSavePresupuesto()}"
                process="frmpresupuesto"
                update="dlgpresupuesto dtpresupuestos"/>
              <p:commandButton 
                value="#{bundle['commons.btn.cancel']}"
                title="#{bundle['commons.btn.cancel']}"
                icon="ui-icon-circle-close"
                actionListener="#{presupuestoController.onCancelSavePresupuesto()}"
                immediate="true"
                update="dlgpresupuesto">
                <p:resetInput 
                  target="pnlpresupuesto" />
              </p:commandButton>
            </p:panelGrid>
          </f:facet>
        </p:panel>
      </h:form>
    </p:dialog> 
  </ui:define>
</ui:composition>